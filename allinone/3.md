ุนุงู! ุญุงูุง ูโุฑู ุณุฑุงุบ **ูุณูุช ฒ: ูุงู `.gitlab-ci.yml` ู ุณุงุฎุชุงุฑ ุขู** โ ฺฉู ููุจ ุงุตู GitLab CI/CD ูุณุช.

---

## ๐น ูุณูุช ฒ: ูุงู `.gitlab-ci.yml` ู ุณุงุฎุชุงุฑ ุขู

ูุงู `.gitlab-ci.yml` ุชู root ูพุฑูฺู ูุฑุงุฑ ูโฺฏุฑู ู **ุชุนุฑู ูโฺฉูู ฺฉู pipeline ุดูุง ฺุทูุฑ ุงุฌุฑุง ุจุดู**. ุงู ูุงู ุจุง ูุฑูุช YAML ููุดุชู ูโุดู ู ุดุงูู ุชุนุฑู jobูุงุ ูุฑุงุญูุ ูุชุบุฑูุงุ ุดุฑุงุท ุงุฌุฑุง ู โฆ ูุณุช.

---

### โ ุณุงุฎุชุงุฑ ูพุงูโุง `.gitlab-ci.yml`

```yaml
stages:
  - build
  - test
  - deploy

build-job:
  stage: build
  script:
    - echo "Building..."

test-job:
  stage: test
  script:
    - echo "Running tests..."

deploy-job:
  stage: deploy
  script:
    - echo "Deploying to production..."
```

---

### โ ุชูุถุญ ุงุฌุฒุงุก ููู

| ุจุฎุด                  | ุชูุถุญ                                                                           |
| -------------------- | ------------------------------------------------------------------------------- |
| `stages`             | ุชุฑุชุจ ุงุฌุฑุง jobูุง ุฑู ุชุนู ูโฺฉูู. ูุฑ stage ุดุงูู ฺูุฏ job ูโุชููู ุจุงุดู.          |
| `script`             | ูุณุช ุฏุณุชูุฑุงุช (Shell commands) ฺฉู ุฏุงุฎู job ุงุฌุฑุง ูโุดู.                           |
| `stage`              | ูุฑ job ุจุงุฏ ูุดุฎุต ฺฉูู ุฏุฑ ฺฉุฏูู stage ุงุฌุฑุง ูโุดู.                                  |
| ูุงู jobโูุง           | ูุซู `build-job`ุ `test-job`ุ ุงุณู ุฏูุฎูุงู ูุณุชูุฏ.                                  |
| ุชุฑุชุจ ุงุฌุฑุง stageโูุง | ุจู ุชุฑุชุจ ูุณุช ฺฉู ุฏุฑ `stages` ูุณุช ูโฺฉู. ุฏุฑูู ูุฑ stage jobูุง ููุงุฒ ุงุฌุฑุง ูโุดู. |

---

### โ ุชุนุฑู ูุชุบุฑูุง

```yaml
variables:
  APP_ENV: production
  DEPLOY_DIR: /var/www/app

deploy-job:
  stage: deploy
  script:
    - echo "Deploying to $DEPLOY_DIR"
```

---

### โ ุดุฑุท ุงุฌุฑุง Job ุจุง `only`, `except`, `rules`

#### `only` ู `except` (ุฑูุด ูุฏูโุชุฑ):

```yaml
job:
  script: echo "Hi"
  only:
    - main
  except:
    - tags
```

#### `rules` (ุฑูุด ุฌุฏุฏุชุฑ ู ูพุดุฑูุชูโุชุฑ):

```yaml
job:
  script: echo "Hi"
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
      when: always
    - when: never
```

---

### โ artifacts ู cache

```yaml
job:
  script:
    - make build
  artifacts:
    paths:
      - build/
  cache:
    paths:
      - node_modules/
```

| ูฺฺฏ       | ุชูุถุญ                                                                    |
| ----------- | ------------------------------------------------------------------------ |
| `artifacts` | ูุงูโูุง ฺฉู ูโุฎูุง ุงุฒ job ุฐุฎุฑู ู ุจู ูุฑุงุญู ุจุนุฏ ููุชูู ฺฉู.             |
| `cache`     | ูุงูโูุง ฺฉู ูโุฎูุง ุจู jobูุง ุง pipelineูุง reuse ฺฉู ุชุง ุณุฑุนุช ุจุดุชุฑ ุดู. |

---

### โ ฺฉ ููููู ูพุดุฑูุชูโุชุฑ

```yaml
stages:
  - build
  - test
  - deploy

variables:
  DEPLOY_ENV: staging

build:
  stage: build
  script:
    - npm install
    - npm run build
  artifacts:
    paths:
      - dist/

test:
  stage: test
  script:
    - npm run test

deploy:
  stage: deploy
  script:
    - echo "Deploying to $DEPLOY_ENV"
  only:
    - main
```

---

### โ Best Practices ุจุฑุง `.gitlab-ci.yml`

* ูุฑุงุญู (`stages`) ุฑู ููุทู ุฏุณุชูโุจูุฏ ฺฉู.
* Jobูุง ุฑู ฺฉูฺฺฉ ู ูุงุถุญ ูฺฏู ุฏุงุฑ.
* ุงุฒ ูุชุบุฑูุง ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชฺฉุฑุงุฑ ุงุณุชูุงุฏู ฺฉู.
* ุงุฒ `rules` ุจุฑุง ฺฉูุชุฑู ุฏูู ุดุฑุงุท ุงุฌุฑุง ุงุณุชูุงุฏู ฺฉู.
* ูุงู YAML ุฑู ูุงฺููุงุฑ ฺฉู ุจุง `include` ุง `extends`.

---

ุงฺฏู ุขูุงุฏูโุงุ ุฏุฑ **ูุณูุช ณ** ูโุฑู ุณุฑุงุบ ุชุนุฑู ุฏููโุชุฑ jobูุง ู stagesุ ู ฺุทูุฑ ุจู jobูุง ูุงุจุณุชฺฏ ุงุฌุงุฏ ฺฉูู.
ุงุฏุงูู ุจุฏูุ
